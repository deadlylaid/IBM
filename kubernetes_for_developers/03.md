# 쿠버네티스 코드와 상호작용

## 목차

1. pod 에서 실행되는 소프트웨어 개발을 위한 실용적인 팁
2. container와 pod에서 로그 수집
3. 실행 중인 pod와 상호작용
4. 쿠버네티스 개념 - Label, Selector
5. 쿠버네티스 리소스
6. pod에서 service 디스커버리



### 이미지 빌드

- 소스코드 저장소에 DockerFile을 함께 저장하는 것은 효율적이다.
- 이미지를 만들기 위한 스크립트 파일을 따로 만들어 두는 것이 좋다.
- 디버깅이 필요하다면 DockerFile-debug 라는 이름으로 따로 만들어서 보관하는 것이 좋다.
- 이미지를 빌드할 때 프로덕션 레벨에서 사용될 수 있음을 염두하는 것이 좋다. 단위 테스트 같은 개발에서 필요한 모듈은 설치하지 않는다.
- 생성한 모든 컨테이너는 읽기 전용으로 설정해야한다. 변경이 필요하면 볼륨을 설정하는 것이 좋다.

###  I/O

- `kubectl logs` 또는 `docker logs` 커맨드 에서는 stdout(표준 출력 스트림), stderr(에러 출력 스트림) 그리고 컨테이너에서 발생하는 모든 로그를 출력하도록 설정되어 있다. 물론 컨테이너 위에서 실행되는 소프트웨어는 로그를 파일시스템에 기록하지 않는다. 불필요한 디스크 I/O가 증가하기 때문이다. 그렇기 때문에 로그 수집기를 구현하고자 한다면, 컨테이너나 pod 외부에 로그를 수집, 전송, 처리 기능을 구현하는 것이 좋다.

### 로그

pod에 2개 이상의 컨테이너가 존재했을 때, 특정 컨테이너의 로그를 확인하고 싶다면 아래의 명령어를 따라하면 된다.

```
# Pod Name : webapp
# container name : flask, background
kubectl logs webapp background
```

